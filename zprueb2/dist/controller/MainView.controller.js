sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/base/Log"],(t,e,a)=>{"use strict";return t.extend("zprueb2.controller.MainView",{onInit:function(){const t=new e({items:[]});t.setSizeLimit(15e5);this.getView().setModel(t,"localModel");this._loadDataFromAPI()},_loadDataFromAPI:function(){const t="http://localhost:3000/api/sapdata";const e=this.getView().getModel("localModel");this.getView().setBusy(true);fetch(t).then(t=>{if(!t.ok){throw new Error("Error al obtener datos: "+t.statusText)}return t.json()}).then(t=>{this._processData(t);e.setProperty("/items",t)}).catch(t=>{a.error("Fallo la carga de datos del API",t)}).finally(()=>{this.getView().setBusy(false)})},_processData:function(t){t.forEach(t=>{let e=t.Iva;let a=this._getPercentage(e);if(t.SubTotal!==undefined){let e=(parseFloat(t.SubTotal)*a).toFixed(2);t.CalculatedTotal=e;t.Match=parseFloat(e)===parseFloat(t.SubTotal)}else{t.CalculatedTotal="N/A";t.Match=false}})},_getPercentage:function(t){const e={BS3:1.1,VS1:1.2,VS2:1.4};return e[t]||1}})});
//# sourceMappingURL=MainView.controller.js.map